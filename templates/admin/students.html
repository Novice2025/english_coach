{% extends "base.html" %}

{% block title %}Manage Students | Magnitude Admin{% endblock %}

{% block content %}
<div class="max-w-7xl mx-auto py-12 px-4">
    <div class="flex flex-col md:flex-row justify-between items-end mb-10">
        <div>
            <h1 class="text-4xl font-black text-slate-900 tracking-tight italic uppercase">Student Directory</h1>
            <p class="text-slate-500 font-bold mt-1 uppercase text-[10px] tracking-[0.3em]">Total Enrolled: {{ students|length }}</p>
        </div>
        <div class="mt-6 md:mt-0">
            <input type="text" id="studentSearch" onkeyup="searchStudents()" placeholder="Search students..." 
                   class="px-6 py-3 rounded-xl bg-white border border-slate-200 text-sm font-bold outline-none focus:border-indigo-500 transition-all w-64 shadow-sm">
        </div>
    </div>

    <div class="bg-white rounded-[2.5rem] border border-slate-200 shadow-2xl shadow-indigo-100/30 overflow-hidden">
        <table class="w-full text-left border-collapse" id="studentTable">
            <thead>
                <tr class="bg-slate-50 border-b border-slate-100">
                    <th class="p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest">Student</th>
                    <th class="p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest">Email</th>
                    <th class="p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest">Total XP</th>
                    <th class="p-6 text-[10px] font-black text-slate-400 uppercase tracking-widest text-right">Actions</th>
                </tr>
            </thead>
            <tbody class="divide-y divide-slate-50">
                {% for student in students %}
                <tr class="hover:bg-slate-50/50 transition-colors group">
                    <td class="p-6">
                        <div class="flex items-center space-x-4">
                            <div class="h-10 w-10 rounded-xl bg-indigo-50 flex items-center justify-center text-indigo-600 font-black text-xs group-hover:scale-110 transition">
                                {{ student.name[0] }}
                            </div>
                            <span class="font-black text-slate-900">{{ student.name }}</span>
                        </div>
                    </td>
                    <td class="p-6 text-sm font-medium text-slate-500">{{ student.email }}</td>
                    <td class="p-6">
                        <span class="inline-flex items-center px-3 py-1 rounded-full bg-indigo-50 text-indigo-600 text-xs font-black">
                            {{ student.xp_points }} XP
                        </span>
                    </td>
                    <td class="p-6 text-right">
                        <button class="text-[10px] font-black text-slate-400 hover:text-indigo-600 uppercase tracking-widest transition">
                            View Progress
                        </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        
        {% if not students %}
        <div class="p-20 text-center">
            <p class="text-slate-400 font-bold italic">No students have joined the arena yet.</p>
        </div>
        {% endif %}
    </div>
</div>

<script>
function searchStudents() {
    let input = document.getElementById("studentSearch");
    let filter = input.value.toUpperCase();
    let table = document.getElementById("studentTable");
    let tr = table.getElementsByTagName("tr");

    for (let i = 1; i < tr.length; i++) {
        let tdName = tr[i].getElementsByTagName("td")[0];
        let tdEmail = tr[i].getElementsByTagName("td")[1];
        if (tdName || tdEmail) {
            let txtValueName = tdName.textContent || tdName.innerText;
            let txtValueEmail = tdEmail.textContent || tdEmail.innerText;
            if (txtValueName.toUpperCase().indexOf(filter) > -1 || txtValueEmail.toUpperCase().indexOf(filter) > -1) {
                tr[i].style.display = "";
            } else {
                tr[i].style.display = "none";
            }
        }
    }
}
</script>
{% endblock %}